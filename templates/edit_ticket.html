{% extends 'base.html' %} {% block content %}

<div class="row">
  <form
    action="{{ url_for('update_ticket', ticket_id=ticket._id) }}"
    method="POST"
  >
    <div class="row">
    <div class="col s12">
      <h3>Edit Ticket - #{{ticket._ticketid}}</h3>
    </div>
    </div>
    <!-- Hidden disabled inputs to allow ticketno & posted_time to repopulate on edit ticket submit -->
    <div class="input-field hide">
      <input id="disabled" name="_ticketid" value="{{ticket._ticketid}}" />
    </div>
    <div class="input-field hide">
      <input
        id="disabled_time"
        name="date_posted"
        value="{{ticket.date_posted}}"
      />
    </div>
    <div class="row">
      <div class="col s12">
        <div class="input-field input-box">
          <input
            id="call_subject"
            name="call_subject"
            type="text"
            class="validate"
            required=""
            aria-required="true"
            value="{{ticket.call_subject}}"
          />
          <label for="call_subject">Ticket Subject</label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col s4">
        <div class="input-field input-box">
          <select id="call_type" name="call_type">
            <option value="" disabled selected>Call type</option>
            {% for type in call_type %} {% if type.call_type == ticket.call_type
            %}
            <option value="{{type.call_type}}" selected>
              {{type.call_type}}</option
            >
            {% else %}
            <option value="{{type.call_type}}"> {{type.call_type}}</option>
            {% endif %} {% endfor %}
          </select>
          <label>Call type</label>
        </div>
      </div>
      <div class="col s4">
        <div class="input-field input-box">
          <select id="call_priority" name="call_priority">
            <option value="" disabled selected>Call priority</option>
            {% for priority in call_priority %} {% if priority.call_priority ==
            ticket.call_priority %}
            <option value="{{priority.call_priority}}" selected>
              {{priority.call_priority}}</option
            >
            {% else %}
            <option value="{{priority.call_priority}}">
              {{priority.call_priority}}</option
            >
            {% endif %} {% endfor %}
          </select>
          <label>Call priority</label>
        </div>
      </div>
      <div class="col s4">
        <div class="input-field input-box">
          <select id="call_status" name="call_status">
            <option value="" disabled selected>Call status</option>
            {% for status in call_status %} {% if status.call_status ==
            ticket.call_status %}
            <option value="{{status.call_status}}" selected>
              {{status.call_status}}</option
            >
            {% else %}
            <option value="{{status.call_status}}">
              {{status.call_status}}</option
            >
            {% endif %} {% endfor %}
          </select>
          <label>Call status</label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col s4">
        <div class="input-field input-box">
          <select id="end_user" name="end_user">
            <option value="" disabled selected>End user</option>
            {% for user in end_user %} {% if user.end_user == ticket.end_user %}
            <option value="{{user.end_user}}" selected>
              {{user.end_user}}</option
            >
            {% else %}
            <option value="{{user.end_user}}"> {{user.end_user}}</option>
            {% endif %} {% endfor %}
          </select>
          <label>End user</label>
        </div>
      </div>
      <div class="col s4">
        <div class="input-field input-box">
          <select id="eu_email" name="eu_email">
            <option value="" disabled selected>Email</option>
            {% for user in eu_email %} {% if user.eu_email == ticket.eu_email %}
            <option value="{{user.eu_email}}" selected>
              {{user.eu_email}}</option
            >
            {% else %}
            <option value="{{user.eu_email}}"> {{user.eu_email}}</option>
            {% endif %} {% endfor %}
          </select>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col s12">
        <div class="input-field input-box">
          <textarea
            id="call_details"
            name="call_details"
            class="materialize-textarea validate"
            required=""
            aria-required="true"
          >
{{ticket.call_details}}</textarea
          >
          <label for="call_details">Call Details</label>
        </div>
      </div>
    </div>
    <div class="row">
    <div class="col s12">
      <button class="btn waves-effect waves-light" type="submit" name="action">
        Submit
        <i class="material-icons right">send</i>
      </button>
      <a
        class="waves-effect waves-light btn"
        href="{{ url_for('get_tickets') }}"
        >Cancel</a
      >
    </div>
    </div>
  </form>
</div>

{% endblock %}
